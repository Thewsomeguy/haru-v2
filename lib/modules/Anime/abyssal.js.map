{"version":3,"sources":["modules/Anime/abyssal.js"],"names":[],"mappings":";;;;AAAA;;;;AACA;;;;AACA;;;;;;;;;;;;IAEM,O;;;;;;;;;;;+BAeQ,I,EAAM,G,EAAK;AACrB,WAAK,IAAL,CAAU,KAAK,OAAf,yBAA6C,IAA7C,YAAwD,GAAxD;AACD;;;+BAEW,K,EAAO;AACjB,WAAK,MAAL,CAAY,KAAZ,CACE,uBAAqB,MAAM,KAAN,CAAY,GAAZ,EAAiB,IAAjB,CAAsB,IAAtB,CAArB,iCADF;AAIA,WAAK,QAAL;AACD;;;4BAEQ,G,EAAK,K,EAAO,I,EAAM;AACzB,UAAI,IAAI,EAAR;AACA,UAAI;AACF,YAAI,KAAK,KAAL,CAAW,IAAI,IAAf,EAAqB,CAArB,CAAJ;AACD,OAFD,CAEE,OAAO,GAAP,EAAY;AACZ,aAAK,MAAL,CAAY,KAAZ,uBAAqC,KAArC,SAA+C,GAA/C;AACA,aAAK,KAAL,uBAA8B,KAA9B,aAA0C,GAA1C;AACA;AACD;AACD,UAAI,KAAK,EAAE,QAAX,EAAqB;AACnB,YAAI,EAAE,MAAF,KAAa,GAAjB,EAAsB;AACpB,eAAK,WAAL,CAAiB,IAAjB,EAAuB,EAAE,QAAzB;AACD,SAFD,MAEO;AACL,eAAK,OAAL,CAAa,GAAb,EAAkB,KAAlB,EAAyB,IAAzB;AACD;AACD;AACD;AACD,WAAK,UAAL,CAAgB,KAAhB,EAAuB,IAAvB;AACA;AACD;;;+BAEW,K,EAAO,I,EAAM;AAAA;;;AAEvB,kCAAI,UAAJ,EAAgB,KAAhB,EAAuB,IAAvB,eACC,IADD,CACM,eAAO;AACX,eAAK,OAAL,CAAa,GAAb,EAAkB,KAAlB,EAAyB,IAAzB;AACD,OAHD;AAID;;;6BAES,I,EAAM,K,EAAO;AAAA;;AACrB,cAAQ,MAAM,KAAN,CAAY,GAAZ,EAAiB,IAAjB,CAAsB,GAAtB,CAAR;AACA,kCAAI,UAAJ,EAAgB,KAAhB,EAAuB,IAAvB,WAAoC,KAAK,KAAL,CAAW,KAAK,MAAL,KAAgB,KAA3B,CAApC,EACC,IADD,CACM,eAAO;AACX,eAAK,OAAL,CAAa,GAAb,EAAkB,KAAlB,EAAyB,IAAzB;AACD,OAHD;AAID;;;4BAEQ,I,EAAM,K,EAAO;AAAA;;AACpB,cAAQ,MAAM,KAAN,CAAY,GAAZ,EAAiB,IAAjB,CAAsB,GAAtB,CAAR;AACA,kCAAI,SAAJ,EAAe,KAAf,EAAsB,IAAtB,EACC,IADD,CACM,UAAC,GAAD,EAAS;AACb,YAAI,IAAI,IAAI,IAAJ,CAAS,CAAT,CAAR;AACA,YAAI,OAAO,CAAP,KAAa,WAAjB,EAA8B;AAC5B,iBAAK,UAAL,CAAgB,IAAhB,EAAsB,EAAE,QAAxB;AACD,SAFD,MAEO;AACL,iBAAK,QAAL,CAAc,IAAd,EAAoB,KAApB;AACD;AACF,OARD;AASD;;;6BAES;AAAA;;AACR,WAAK,QAAL,CAAc,YAAd,EAA4B,YAAM;AAChC,YAAI,OAAO,kBAAG,QAAd;AACA,YAAI,OAAO,KAAK,KAAK,KAAL,CAAW,KAAK,MAAL,KAAgB,KAAK,MAAhC,CAAL,EAA8C,KAA9C,CAAoD,MAApD,CAAX;AACA,eAAK,OAAL,CAAa,KAAK,CAAL,CAAb,EAAsB,KAAK,CAAL,CAAtB;AACD,OAJD;AAKD;;;wBAlFkB;AACjB,aAAO,SAAP;AACD;;;wBAEyB;AACxB,aAAO,sBAAP;AACD;;;wBAEmB;AAClB,aAAO,CACL,CAAC,oCAAD,CADK,CAAP;AAGD;;;;;;AAyEH,OAAO,OAAP,GAAiB,OAAjB","file":"modules/Anime/abyssal.js","sourcesContent":["import BaseCommand from '../../base/BaseCommand'\nimport img from '../.Cache/ImageFetcher'\nimport DB from '../.Cache/WaifuDB'\n\nclass Abyssal extends BaseCommand {\n  static get name () {\n    return 'abyssal'\n  }\n\n  static get description () {\n    return 'Finds you an abyssal'\n  }\n\n  static get usage () {\n    return [\n      ['**abyssal** - Finds you an abyssal']\n    ]\n  }\n\n  abyssalGet (name, url) {\n    this.send(this.channel, `Your abyssal is **${name}**\\n${url}`)\n  }\n\n  noPictures (query) {\n    this.logger.error(\n      `**Error**: Query \"${query.split('+').join(', ')}\"` +\n      ` returned no pictures.`\n    )\n    this.getWaifu()\n  }\n\n  fetchGB (res, query, name) {\n    let r = []\n    try {\n      r = JSON.parse(res.text)[0]\n    } catch (err) {\n      this.logger.error(`Error fetching '${query}'`, err)\n      this.reply(`Error fetching '${query}' - ${err}`)\n      return\n    }\n    if (r && r.file_url) {\n      if (r.rating === 's') {\n        this.shipgirlGet(name, r.file_url)\n      } else {\n        this.fetchGB(res, query, name)\n      }\n      return\n    }\n    this.reducePage(query, name)\n    return\n  }\n\n  reducePage (query, name) {\n    // Temporary workaround for tags with less than 10000 images\n    img('gelbooru', query, this, `limit=100`)\n    .then(res => {\n      this.fetchGB(res, query, name)\n    })\n  }\n\n  gelbooru (name, query) {\n    query = query.split(' ').join('_')\n    img('gelbooru', query, this, `pid=${Math.floor(Math.random() * 10000)}`)\n    .then(res => {\n      this.fetchGB(res, query, name)\n    })\n  }\n\n  yandere (name, query) {\n    query = query.split(' ').join('_')\n    img('yandere', query, this)\n    .then((res) => {\n      let r = res.body[0]\n      if (typeof r !== 'undefined') {\n        this.abyssalGet(name, r.file_url)\n      } else {\n        this.gelbooru(name, query)\n      }\n    })\n  }\n\n  handle () {\n    this.responds(/^abyssal$/i, () => {\n      let data = DB.Abyssals\n      let char = data[Math.floor(Math.random() * data.length)].split(' || ')\n      this.yandere(char[0], char[1])\n    })\n  }\n}\n\nmodule.exports = Abyssal\n"],"sourceRoot":"/Users/AaronTua/Desktop/code/fuyu/src"}